<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.6: http://docutils.sourceforge.net/" />
<title></title>
<style type="text/css">

/*
:Author: David Goodger (goodger@python.org)
:Id: $Id: html4css1.css 5951 2009-05-18 18:03:10Z milde $
:Copyright: This stylesheet has been placed in the public domain.

Default cascading style sheet for the HTML output of Docutils.

See http://docutils.sf.net/docs/howto/html-stylesheets.html for how to
customize this style sheet.
*/

/* used to remove borders from tables and images */
.borderless, table.borderless td, table.borderless th {
  border: 0 }

table.borderless td, table.borderless th {
  /* Override padding for "table.docutils td" with "! important".
     The right padding separates the table cells. */
  padding: 0 0.5em 0 0 ! important }

.first {
  /* Override more specific margin styles with "! important". */
  margin-top: 0 ! important }

.last, .with-subtitle {
  margin-bottom: 0 ! important }

.hidden {
  display: none }

a.toc-backref {
  text-decoration: none ;
  color: black }

blockquote.epigraph {
  margin: 2em 5em ; }

dl.docutils dd {
  margin-bottom: 0.5em }

/* Uncomment (and remove this text!) to get bold-faced definition list terms
dl.docutils dt {
  font-weight: bold }
*/

div.abstract {
  margin: 2em 5em }

div.abstract p.topic-title {
  font-weight: bold ;
  text-align: center }

div.admonition, div.attention, div.caution, div.danger, div.error,
div.hint, div.important, div.note, div.tip, div.warning {
  margin: 2em ;
  border: medium outset ;
  padding: 1em }

div.admonition p.admonition-title, div.hint p.admonition-title,
div.important p.admonition-title, div.note p.admonition-title,
div.tip p.admonition-title {
  font-weight: bold ;
  font-family: sans-serif }

div.attention p.admonition-title, div.caution p.admonition-title,
div.danger p.admonition-title, div.error p.admonition-title,
div.warning p.admonition-title {
  color: red ;
  font-weight: bold ;
  font-family: sans-serif }

/* Uncomment (and remove this text!) to get reduced vertical space in
   compound paragraphs.
div.compound .compound-first, div.compound .compound-middle {
  margin-bottom: 0.5em }

div.compound .compound-last, div.compound .compound-middle {
  margin-top: 0.5em }
*/

div.dedication {
  margin: 2em 5em ;
  text-align: center ;
  font-style: italic }

div.dedication p.topic-title {
  font-weight: bold ;
  font-style: normal }

div.figure {
  margin-left: 2em ;
  margin-right: 2em }

div.footer, div.header {
  clear: both;
  font-size: smaller }

div.line-block {
  display: block ;
  margin-top: 1em ;
  margin-bottom: 1em }

div.line-block div.line-block {
  margin-top: 0 ;
  margin-bottom: 0 ;
  margin-left: 1.5em }

div.sidebar {
  margin: 0 0 0.5em 1em ;
  border: medium outset ;
  padding: 1em ;
  background-color: #ffffee ;
  width: 40% ;
  float: right ;
  clear: right }

div.sidebar p.rubric {
  font-family: sans-serif ;
  font-size: medium }

div.system-messages {
  margin: 5em }

div.system-messages h1 {
  color: red }

div.system-message {
  border: medium outset ;
  padding: 1em }

div.system-message p.system-message-title {
  color: red ;
  font-weight: bold }

div.topic {
  margin: 2em }

h1.section-subtitle, h2.section-subtitle, h3.section-subtitle,
h4.section-subtitle, h5.section-subtitle, h6.section-subtitle {
  margin-top: 0.4em }

h1.title {
  text-align: center }

h2.subtitle {
  text-align: center }

hr.docutils {
  width: 75% }

img.align-left, .figure.align-left{
  clear: left ;
  float: left ;
  margin-right: 1em }

img.align-right, .figure.align-right {
  clear: right ;
  float: right ;
  margin-left: 1em }

.align-left {
  text-align: left }

.align-center {
  clear: both ;
  text-align: center }

.align-right {
  text-align: right }

/* reset inner alignment in figures */
div.align-right {
  text-align: left }

/* div.align-center * { */
/*   text-align: left } */

ol.simple, ul.simple {
  margin-bottom: 1em }

ol.arabic {
  list-style: decimal }

ol.loweralpha {
  list-style: lower-alpha }

ol.upperalpha {
  list-style: upper-alpha }

ol.lowerroman {
  list-style: lower-roman }

ol.upperroman {
  list-style: upper-roman }

p.attribution {
  text-align: right ;
  margin-left: 50% }

p.caption {
  font-style: italic }

p.credits {
  font-style: italic ;
  font-size: smaller }

p.label {
  white-space: nowrap }

p.rubric {
  font-weight: bold ;
  font-size: larger ;
  color: maroon ;
  text-align: center }

p.sidebar-title {
  font-family: sans-serif ;
  font-weight: bold ;
  font-size: larger }

p.sidebar-subtitle {
  font-family: sans-serif ;
  font-weight: bold }

p.topic-title {
  font-weight: bold }

pre.address {
  margin-bottom: 0 ;
  margin-top: 0 ;
  font: inherit }

pre.literal-block, pre.doctest-block {
  margin-left: 2em ;
  margin-right: 2em }

span.classifier {
  font-family: sans-serif ;
  font-style: oblique }

span.classifier-delimiter {
  font-family: sans-serif ;
  font-weight: bold }

span.interpreted {
  font-family: sans-serif }

span.option {
  white-space: nowrap }

span.pre {
  white-space: pre }

span.problematic {
  color: red }

span.section-subtitle {
  /* font-size relative to parent (h1..h6 element) */
  font-size: 80% }

table.citation {
  border-left: solid 1px gray;
  margin-left: 1px }

table.docinfo {
  margin: 2em 4em }

table.docutils {
  margin-top: 0.5em ;
  margin-bottom: 0.5em }

table.footnote {
  border-left: solid 1px black;
  margin-left: 1px }

table.docutils td, table.docutils th,
table.docinfo td, table.docinfo th {
  padding-left: 0.5em ;
  padding-right: 0.5em ;
  vertical-align: top }

table.docutils th.field-name, table.docinfo th.docinfo-name {
  font-weight: bold ;
  text-align: left ;
  white-space: nowrap ;
  padding-left: 0 }

h1 tt.docutils, h2 tt.docutils, h3 tt.docutils,
h4 tt.docutils, h5 tt.docutils, h6 tt.docutils {
  font-size: 100% }

ul.auto-toc {
  list-style-type: none }

</style>
</head>
<body>
<div class="document">


<!-- .
////////////////////////////////////////////////////////////////////////
//           _ ___               _                                    //
//          (_)__ \             | |                                   //
//  ___  ___ _   ) |_      _____| |                                   //
// / __|/ __| | / /\ \ /\ / / _ \ '_ \                                //
// \__ \ (__| |/ /_ \ V  V /  __/ |_) |                               //
// |___/\___|_|____| \_/\_/ \___|_.__/                                //
//                                                                    //
// Bringing naturally developed scientific applications to the web    //
// Jorge Zuluaga (2011)                                               //
////////////////////////////////////////////////////////////////////////
. -->
<!-- .
////////////////////////////////////////////////////////////////////////
//           _ ___               _                                    //
//          (_)__ \             | |                                   //
//  ___  ___ _   ) |_      _____| |                                   //
// / __|/ __| | / /\ \ /\ / / _ \ '_ \                                //
// \__ \ (__| |/ /_ \ V  V /  __/ |_) |                               //
// |___/\___|_|____| \_/\_/ \___|_.__/                                //
//                                                                    //
// Bringing naturally developed scientific applications to the web    //
// Jorge Zuluaga (2011)                                               //
////////////////////////////////////////////////////////////////////////
. -->
<!-- .
//////////////////////////////////////////////////////////////////////
//ROLES
//////////////////////////////////////////////////////////////////////
. -->
<style>.red{color:red}</style><!-- See more at: http://docutils.sourceforge.net/docs/ref/rst/definitions.html -->
<!-- This data file has been placed in the public domain. -->
<!-- Derived from the Unicode character mappings available from
<http://www.w3.org/2003/entities/xml/>.
Processed by unicode2rstsubs.py, part of Docutils:
<http://docutils.sourceforge.net>. -->
<!-- .. include:: <isoamsb.txt>
.. include:: <isoamsc.txt>
.. include:: <isoamso.txt>
.. include:: <isoamsr.txt>
.. include:: <isogrk1.txt> -->
<img alt="../images/sci2web-mainlogo.jpg" src="../images/sci2web-mainlogo.jpg" style="height: 100px;" />
<div class="section" id="developer-guide">
<h1><a class="toc-backref" href="#id1">Developer Guide</a></h1>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Author:</th><td class="field-body">Jorge Zuluaga</td>
</tr>
<tr class="field"><th class="field-name">Version:</th><td class="field-body">Revision 1, Wed Nov 30 06:29:15 COT 2011</td>
</tr>
<tr class="field"><th class="field-name">Copyright:</th><td class="field-body">This document has been placed in the public domain.</td>
</tr>
</tbody>
</table>
<div class="contents topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#developer-guide" id="id1">Developer Guide</a><ul>
<li><a class="reference internal" href="#abstract" id="id2">Abstract</a></li>
<li><a class="reference internal" href="#presenting-sci2web" id="id3">Presenting Sci2Web</a></li>
<li><a class="reference internal" href="#quick-start-summary" id="id4">Quick start (Summary)</a></li>
<li><a class="reference internal" href="#testing-your-application-in-the-command-line" id="id5">Testing your application in the command line</a></li>
<li><a class="reference internal" href="#preparing-the-application" id="id6">Preparing the application</a><ul>
<li><a class="reference internal" href="#initialize-your-application-as-a-sci2web-application" id="id7">Initialize your application as a Sci2Web application</a></li>
<li><a class="reference internal" href="#select-the-control-variables" id="id8">Select the <em>control variables</em></a></li>
<li><a class="reference internal" href="#configure-your-application" id="id9">Configure your application</a></li>
</ul>
</li>
<li><a class="reference internal" href="#installing-your-application-in-your-sci2web-server-site" id="id10">Installing your application in your Sci2Web server site</a></li>
<li><a class="reference internal" href="#testing-your-newly-ported-application" id="id11">Testing your newly ported application</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="abstract">
<h2><a class="toc-backref" href="#id2">Abstract</a></h2>
<p>This document explains how to port an application to a <a class="reference external" href="http://localhost/user/Sci2WebPP">Sci2Web</a> server
site.  The process of porting a <em>Naturally Developed Scientific
Application (NDSA)</em> starts by testing your application at the web
server where it will be installed.  You need to be sure that your
application runs properly from the command line before trying to
configure and control it from a web interface.  If the application
depends on third party software (libraries, languages, external
packages, etc.) they could be installed in the web server or simply
copied among the application files.  By porting an application to
<a class="reference external" href="http://localhost/user/Sci2WebPP">Sci2Web</a> minor modifications should be done on the application source
files (if available) and no web or graphical programming is required
at all.  This is the most important advantage of using <a class="reference external" href="http://localhost/user/Sci2WebPP">Sci2Web</a> to
create a friendly interface to your applications.  Many properties of
the web interface and the mechanisms used by <a class="reference external" href="http://localhost/user/Sci2WebPP">Sci2Web</a> to control the
preparation and running of the application can be configured and
customized as will be explained here.  If you have already ported an
application and want to test it read the <a class="reference external" href="user.txt">Sci2Web user guide</a>.</p>
</div>
<div class="section" id="presenting-sci2web">
<h2>Presenting <a class="reference external" href="http://localhost/user/Sci2WebPP">Sci2Web</a></h2>
<p><a class="reference external" href="http://localhost/user/Sci2WebPP">Sci2Web</a> is a tool to provide graphical web interfaces to <em>Naturally
Developed Scientific Applications</em> (NDSAs).  NDSAs is a generic name
we use to call those programs developed or adapted by scientist and
used in scientific research.  Although today you can find powerful
scientific software providing advanced graphical and user interfaces
(e.g. Reduce, SAGE, Mathematica, Matlab) many scientific work still
depend on programs developed in low level programming languages (C,
fortran).  Even although a growing number of scientist are using
powerful and modern languajes (C++, Java, Python) their programs still
have simplified user interfaces and most of them lack of a proper
graphical interface (in most cases these interfaces are simply not
required or not important in the scientific work).</p>
<p>Most of the time scientists restrict their programs just for their
personal use or share it only with close colleagues.  But from time to
time a <em>good piece of code</em> arises having the potential to become a
publickly available program.  The decision to share a program and
allows other to use it is a wise decision that in some cases have a
very positive impact on the visibility of the developer scientific
work.  However the development of software intended for <em>final users</em>,
even although they could be experts, could be a challenge even for a
skillful scientific developer.  Many skills are required ranging from
operating system programming to advanced graphical interfaces
development.</p>
<p><a class="reference external" href="http://localhost/user/Sci2WebPP">Sci2Web</a> is a solution created for those scientist who desire to share
the software they developed with a wider scientific community but to
the lowest developing cost.  Imagine to have an <em>active web page</em> (a
web page whose content changes according to the user input) able to
configure and control the execution of your programs?  This is exactly
what <a class="reference external" href="http://localhost/user/Sci2WebPP">Sci2Web</a> provides you.  If you want to see a living example go
now to the <a class="reference external" href="http://www.google.com">Diffusion application</a>.</p>
<p><a class="reference external" href="http://localhost/user/Sci2WebPP">Sci2Web</a> is not a content or a version management software.  It simply
provides the required tools to configure and run NDSA applications
using the web.</p>
</div>
<div class="section" id="quick-start-summary">
<h2><a class="toc-backref" href="#id4">Quick start (Summary)</a></h2>
<p>If you have not enough patience to read the rest of this document and
think that you can <em>interpolate</em> many of the details regarding the
configuration of a new <a class="reference external" href="http://localhost/user/Sci2WebPP">Sci2Web</a> application, follow the next steps and
get an usable web interface to your NDSA in a couple of minutes:</p>
<ol class="arabic">
<li><p class="first">Place all your application files and any other third party files in
a single directory.</p>
</li>
<li><p class="first">Test your application in the command line and be sure it runs
properly solving all the potential dependencies.</p>
</li>
<li><p class="first">Initialize your application as a <a class="reference external" href="http://localhost/user/Sci2WebPP">Sci2Web</a> application:</p>
<pre class="literal-block">
% perl SCI2WEB_PROJPATH/sci2web.pl init --appname &lt;ApplicationName&gt; --vername &lt;VersionName&gt; --emails &lt;ContributorEmails&gt; --changeslog &lt;ShortDescription&gt;
</pre>
</li>
<li><p class="first">Identify those files containing the <em>control variables</em> (variables
the final user could change using the web interface), create
templates for each of them and replace the variable for a
substitution rule:</p>
<pre class="literal-block">
% cp parameters.ini .parameters.ini.temp
</pre>
<p>Original content:</p>
<pre class="literal-block">
10000
0.1
3 5
</pre>
<p>New content:</p>
<pre class="literal-block">
[[NumberParticles::10000::int::Total number of particules]]
[[MeanFreePath::0.1::float::Mean free path]]
[[Width::3::float]] [[Heigh::5::float]]
</pre>
</li>
<li><p class="first">Identify the results variables and describe it using substitution
rules in the file <tt class="docutils literal">.results.info.temp</tt> (a copy of this file could
be found in the <tt class="docutils literal">sci2web</tt> directory but it is recommended to copy
it into the root directory of the application.</p>
</li>
<li><p class="first">(optative) Modify the code to allow pausing, stopping and resuming
actions.  Also include code to check the status of the execution.</p>
</li>
<li><p class="first">Compile the control and result variables and fill automatically
other configuration files for the application:</p>
<pre class="literal-block">
% perl sci2web/bin/sci2web.pl contvars --appdir .
</pre>
</li>
<li><p class="first">Check the generation of source files from template files using the
default value of control variables:</p>
<pre class="literal-block">
% perl sci2web/bin/sci2web.pl genfiles --runconf sci2web/templates/Default.conf --rundir .
</pre>
</li>
<li><p class="first">Configure your application.  To perform this task edit the
following files following the instructions outlined in their
templates (we assume that all the files are in the <tt class="docutils literal">sci2web</tt>
subdirectory): <tt class="docutils literal">version.conf</tt>, <tt class="docutils literal">runpipeline.conf</tt>,
<tt class="docutils literal">resultswindows.conf</tt>, <tt class="docutils literal">sharedfiles.info</tt>, <tt class="docutils literal">outfiles.info</tt></p>
</li>
<li><p class="first">Test the <em>run pipeline</em>:</p>
<pre class="literal-block">
% bash sci2web/bin/sci2web.sh test
</pre>
</li>
<li><p class="first">Install your application version in a <a class="reference external" href="http://localhost/user/Sci2WebPP">Sci2Web</a> server site:</p>
<pre class="literal-block">
% perl SCI2WEB_PATH/bin/sci2web.pl install --appdir .
</pre>
</li>
<li><p class="first">Test it!</p>
</li>
</ol>
</div>
<div class="section" id="testing-your-application-in-the-command-line">
<h2><a class="toc-backref" href="#id5">Testing your application in the command line</a></h2>
<p>The scenario: you have just finished to debug a piece of sofware you
have been using in your research.  The software seems interesting
enough for other scientists working in your field and you finally
decided to share it with colleagues.</p>
<p>Your software is a bunch of source files written probably in different
languages, data files, scripts and third party tools (binaries,
libraries, header files, etc.) included or not among your files.</p>
<p>The user interacts with your program in different ways.  It is
probably that your software uses specially formatted input files to
set up the program and takes other input data, on which probably the
action occurs, from other data files.  It is also possible that some
information enters to your programs and scripts through the command
line.  More strange is that your software depends on some input given
from the keyboard.  In that case and as a general rule of thumb we
recommend to avoid any interactive input since it will make harder to
run the program in batch mode (unsupervised runs).</p>
<p>The output of the program can be also diverse ranging from data going
to the standard output and standard error, new data files and why not
a figure or a plot produced by some plotting program (e.g. gnuplot).
Again we recommend that all plots produced by your software be
redirected to an image file eliminating any dependence of an available
X connection.</p>
<p>If you are organized enough your application includes also a simple
documentation prepared in some kind of readable format (text or html
files).</p>
<p>All these features are typical of most of the applications developed
by scientist as part of their research.  We are calling here this type
of software <em>Naturally Developed Scientific Applications, NDSA</em>.  A
pictorial model of the structure and interface of a generic NDSA is
depicted in figure 1.</p>
<img alt="images/NDSA-interface-model.jpg" src="images/NDSA-interface-model.jpg" />
<p>The first condition you have to meet in order to configure and control
your application with <a class="reference external" href="http://localhost/user/Sci2WebPP">Sci2Web</a> is that the application compiles and
run properly from the command line.  You should perform this test in
order to check if all the third party software (inlcuding compilers
and libraries) are installed.  Another reason to make this first test
is to see if the program at run time is able to load <em>share libraries</em>
an issue not always easy to solve.</p>
</div>
<div class="section" id="preparing-the-application">
<h2><a class="toc-backref" href="#id6">Preparing the application</a></h2>
<p>It is time to configure your application in order to use <a class="reference external" href="http://localhost/user/Sci2WebPP">Sci2Web</a> as
the web interface to control it.  In the following we will call this
procedure <em>application porting</em>.  To illustrate how to port an
application to <a class="reference external" href="http://localhost/user/Sci2WebPP">Sci2Web</a> we will work with the sample application
already installed in the <a class="reference external" href="http://localhost/user/Sci2WebPP">Sci2Web</a> server site you have installed.  A
fresh copy of the example application is found at <tt class="docutils literal">doc/examples</tt>.</p>
<p>Try to follow the procedure described below using your own
application.</p>
<p>Our sample application has been copied and tested in a directory
called <tt class="docutils literal">Diffusion</tt>.  This directory could be placed anywhere in your
server.</p>
<p>Our example application has the following components:</p>
<ul class="simple">
<li>Source files: diffusion.c, diffusion.h, Makefile.</li>
<li>Input files: parameters.ini</li>
<li>Third party software: C compiler (external), gsl library (external)
and gsl header files (included among the files of the application).</li>
<li>Extra: an empty directory called <tt class="docutils literal">scratch</tt> where temporal data
files are stored in running time.</li>
</ul>
<p>In order to run the application we should compile it:</p>
<pre class="literal-block">
% make diffusion.out
</pre>
<p>and run it passing the name of the output file through the command
line:</p>
<pre class="literal-block">
% ./diffusion.out salida.txt
</pre>
<p>The application computes the trajectory in a random walk of a given
number of <em>dust</em> particles (by default 10000) inside a twi dimensional
rectangular box.  The purpose is to compute several statistical
properties of the system such as the average number of dispersions and
the final distribution of dust particles in the box walls.</p>
<p>When the program is ran, it shows in the screen (standard output) the
last position of a selected number of particles (by default 1 each
100).  Additionally, for the particles whose position is shown in the
screen the program stores all the points in its random trajectory.
The trajectory is stored in the directory <tt class="docutils literal">scratch</tt> in files called
<tt class="docutils literal"><span class="pre">path-&lt;i&gt;.dat</span></tt> where <tt class="docutils literal">&lt;i&gt;</tt> is the number of the particle.</p>
<p>The next steps require some help of a set of special scripts called
the <strong>Sci2Web utility scripts</strong>.  The scripts are located in the
directory <tt class="docutils literal">SCI2WEB_PROJPATH/bin</tt> where <tt class="docutils literal">SCI2WEB_PROJPATH</tt> is the
directory where <a class="reference external" href="http://localhost/user/Sci2WebPP">Sci2Web</a> was installed in your server
(e.g. <tt class="docutils literal">/var/www/Sci2Web</tt>).  You may want to include this directory
in your path to simplify the following steps.  In other case you will
have to invoque the scripts using the complete path.</p>
<div class="section" id="initialize-your-application-as-a-sci2web-application">
<h3><a class="toc-backref" href="#id7">Initialize your application as a Sci2Web application</a></h3>
<p>All the <a class="reference external" href="http://localhost/user/Sci2WebPP">Sci2Web</a> configuration information about your application is
stored in specially formatted files that should be copied and edited
in the directory of your application.  You can initialize all those
files with a single command using the perl <em>utility script</em>
<tt class="docutils literal">sci2web.pl</tt>:</p>
<pre class="literal-block">
% perl SCI2WEB_PROJPATH/sci2web.pl init --appname &lt;ApplicationName&gt; --vername &lt;VersionName&gt; --emails &lt;ContributorsEmails&gt; --changeslog &lt;ShortDescription&gt;
</pre>
<p>where <tt class="docutils literal">&lt;ApplicationName&gt;</tt> is the name of your application and
<tt class="docutils literal">&lt;VersionName&gt;</tt> is the name of the version you are presently
configuring.  <tt class="docutils literal">&lt;ContributorsEmails&gt;</tt> is a list of the <tt class="docutils literal">;</tt>
separated e-mails of the contributors of this version of the
application.  The contributors emails will be used to identify which
users has super user grants on the version webpage.
<tt class="docutils literal">&lt;ShortDescription&gt;</tt> is a short description of this version and how
it is different from previous ones.</p>
<div class="important">
<p class="first admonition-title">Important</p>
<p>Applications in Sci2Web should have proper names that
will be used to identify them not only in the database, the
filesystem or in all the programs of the tool, but also in the web
pages of the server site. We strongly recommend to choose properly
the names of you applications.  For example avoid the use of
<em>cryptic</em> names or very short or encoded names and please <strong>DO
NOT</strong> use spaces or special symbols in the names of your
application.</p>
<p class="last">Each Application could have multiple versions.  This is a very
important feature of <a class="reference external" href="http://localhost/user/Sci2WebPP">Sci2Web</a>.  Since scientific application evolve
sometimes very fastly and it is hard to ask users to follow any
change you make in your application, versions will be the way as
the developer takes <em>snapshot</em> of its work and release static
versions of the application.  If new changes must be done on a
given version of your application is better to create a new version
instead of change an existing one.  To reduce the burden of create
versions for any change you make on your applications (actually not
all changes will require the creation of completely new versions,
the most critical changes involve the control variables defined in
the next section) we recommend the creation of an initial version
of any application called the <tt class="docutils literal">dev</tt> version intended to be
continuously modified.  Final users will not be able to see that
version.</p>
</div>
<p>To initialize our sample application the command will be:</p>
<pre class="literal-block">
% perl SCI2WEB_PROJPATH/sci2web.pl init --appname TestDiffusion --vername dev --emails test&#64;sci2web.org --changeslog &quot;Development version&quot;
</pre>
<p>Please notice that we are using the name <tt class="docutils literal">TestDiffusion</tt> instead of
<tt class="docutils literal">Diffusion</tt> simply because an application with that name has been
already installed with the initial files of the server site.</p>
<p>As has been said before the initialization step creates all the
configuration files required to set up a Sci2Web application and
gather them in a single subdirectory named <tt class="docutils literal">sci2web</tt>.  Do not move
or change the name of this subdirectory.</p>
<p>Once your application has been initialized you have to fill out the
configuration files.  Several files are automatically filled using the
utility scripts by other ones should be eidted manually.</p>
</div>
<div class="section" id="select-the-control-variables">
<h3><a class="toc-backref" href="#id8">Select the <em>control variables</em></a></h3>
<p>The first step to configure a <a class="reference external" href="http://localhost/user/Sci2WebPP">Sci2Web</a> ported application, is to
select the variables that could be controlled by the user.  We will
call them the <em>control variables</em>.  The value of the control variables
will be passed by the user using a web form in the <a class="reference external" href="http://localhost/user/Sci2WebPP">Sci2Web</a> interface.</p>
<p>The most natural source of control variables are the input files.  In
our sample application case this role is played by the
<tt class="docutils literal">parameters.ini</tt> file:</p>
<pre class="literal-block">
10000
0.1
3 5
</pre>
<p>The first value in this file is the total number of particles that
will be used in the simulation.  The second one is the mean free path
in program units (see below).  The fourth and fifth parameters are the
width and height of the box also in the units of the program.</p>
<p>If you want that the user controls the value of all this variables
create a copy of this file with the name <tt class="docutils literal">.parameters.ini.temp</tt>
(<em>template file</em>) and substitute the values of the variables by:</p>
<pre class="literal-block">
[[NumberParticles::10000::int::Total number of particules]]
[[MeanFreePath::0.1::float::Mean free path]]
[[Width::3::float]] [[Heigh::5::float]]
</pre>
<p>The code between double square brackets is called <em>substitution rules</em>
and have two functions: 1) <em>tag</em> the place in a file where a control
variable should be replaced by the value given by the user and 2)
provide complete information to <a class="reference external" href="http://localhost/user/Sci2WebPP">Sci2Web</a> about the control variables
itself, such as the internal name of the variable, the <em>numeric</em> type
and even the help text that will appear close to the input element in
the web form (see below).</p>
<p>The general syntax of a substitution rule is:</p>
<pre class="literal-block">
[[VariableName::DefaultValue::TypeOfVariable::CompleteName::Tab::Group::HelpText::ReadOnly]]
</pre>
<p>Where:</p>
<ul>
<li><p class="first"><strong>VariableName</strong>: the name of the variable at the programming
level.  It should obeys the typical rules of variable names (e.g. no
blank or special characters)</p>
</li>
<li><p class="first"><strong>DefaultValue</strong>: default value of the variable and type of input in
the web interface.  There are different ways to specify the default
value of a control variable.  Each way determines which input
element will be used in the web form:</p>
<ul class="simple">
<li><em>Single value</em> (e.g. 3): the input is a simple text box.</li>
<li><em>Range of values</em> (e.g. 0--10==5): double dash separated range of
values plus the default value assumed in that range.  In this case
the input is performed using a simple text box plus a scroll bar.
This method is strongly recommended when certain values of a
variable should be avoided.</li>
<li><em>List of values</em> (e.g. Yes;;No==Yes): double comma separated set
of values plus the default selected one.  Input is performed using
a selection tool.</li>
</ul>
<p>Another type of input methods are used according to the variable
type (see next item):</p>
<ul class="simple">
<li><em>Boolean values</em> (e.g. 1 or 0): value is indicated as 1 or 0.
Input is performed using a checkbox.</li>
<li><em>Files</em>: Input is performed using an upload button.</li>
<li><em>Text</em>: Input is performed with a textarea element.</li>
</ul>
<div class="important">
<p class="first admonition-title">Important</p>
<p class="last">The input method determined by the variable type
overrides the DefaultValue specification.  For example if you
create a variable with Default value <tt class="docutils literal"><span class="pre">Yes;;No==Yes</span></tt> of type
<tt class="docutils literal">text</tt> the input will be through a textarea element instead of
a select element as expected from the default value
specification.</p>
</div>
</li>
<li><p class="first"><strong>Type of variable</strong>: most of the types follows the mysql convention
without modifiers (e.g. int instead of int(8)).  Other types are
specific to <a class="reference external" href="http://localhost/user/Sci2WebPP">Sci2Web</a> (text,bool,file).  Valida datatypes are: int,
float, varchar, bool, file and text.</p>
</li>
<li><p class="first"><strong>Complete name of the variable</strong>.  This name will be used as the
text before the input element in the web form.</p>
</li>
<li><p class="first"><strong>Tab</strong>: the configuration window used to input the application
control variables is divided in tabs.  Tabs allows you to create
group of control variables having different effects on the
applications.  For example you can distinguish among variables with
the value of physical properties of your applications and variables
controlling numerical attributes.  The Tab field in the substitution
rule allows you to classify you control variables.  Variables
without a Tab attribute will be classified in a <tt class="docutils literal">Control
Variables</tt> default tab.</p>
</li>
<li><p class="first"><strong>Group</strong>: in each tab variables are organized by groups.  This a
second level of organization introduced specially to be used with
very complex applications.  Variables without a Group attribute will
be classified in a <tt class="docutils literal">General</tt> default group.</p>
</li>
<li><p class="first"><strong>ReadOnly</strong>: this property is used to enable or disable the
possibility to change the control variable through the web form.
Left blank if you want to enable the input of the variable and use
<tt class="docutils literal">readonly</tt> to disable the input.</p>
</li>
</ul>
<p>If you have a control variable in more than one file you should create
a template version of those files and place therein the respective
substitution rules.  In our sample application the file
<tt class="docutils literal"><span class="pre">plot-out.gpl</span></tt> contains the number of particles as part of the figure
title.  In that case create a template copy <tt class="docutils literal"><span class="pre">.plot-out.gpl.temp</span></tt> and
put the substitution rule for the control vairable
<tt class="docutils literal">NumberParticles</tt>:</p>
<pre class="literal-block">
name=&quot;[[OutputFile::salida::varchar::Name of the output file]]&quot;
set title &quot;Diffusion of [[NumberParticles]] particles&quot;
set term png
set output name.'.png'
plot name.'.txt' u 2:3 w p
</pre>
<p>Please notice that you do not need to use the complete substitution
rule in the second template file.  This behavior will save a lot of
work when parametrizing your application.</p>
<p>It is interesting to notice that control variables are not only
associated to <em>values</em> of real programming variables in your source
files.  Actually they can substitute complete parts of your files
regardless the content of the file or the role of the substituted
part.  In the <tt class="docutils literal">parameters.ini</tt> example the control variable
substitute a single numeric value but in the <tt class="docutils literal"><span class="pre">plot-out.gpl</span></tt> example
substitute part of a string.</p>
<div class="important">
<p class="first admonition-title">Important</p>
<p>to simplify the parametrization of complex applications
we recommend to create a master template file
<tt class="docutils literal">.defaultvalues.conf.temp</tt> containing the full substitution rules
for all the control variables in your application.  Using this file
you will avoid to fill your application template files with long
substitution rules that will be made those file probably prune to
errors.  In our sample application this master template file could
be have the following lines:</p>
<pre class="literal-block">
NumberParticles=[[NumberParticles::10000::int::Total number of particules]]
MeanFreePath=[[MeanFreePath::0.1::float::Mean free path]]
Width=[[Width::3::float]]
Height=[[Heigh::5::float]]
OutputFile=[[OutputFile::salida::varchar::Name of the output file]]
</pre>
<p>Once this file is created the application template files
<tt class="docutils literal">.parameters.ini.temp</tt> and <tt class="docutils literal">.plot.gpl.temp</tt> will just contain
simplified versions of the substitution rules.  For example the
<tt class="docutils literal">.parameters.ini.temp</tt> will now look much readable:</p>
<pre class="last literal-block">
[[NumberParticles]]
[[MeanFreePath]]
[[Width]] [[Heigh]]
</pre>
</div>
<p>There are finally a set of very important variables that should be set
up to complete the <em>parametrization</em> of your application. They are
called the <em>results variables</em>.  These variables are set up using an
already created template file <tt class="docutils literal"><span class="pre">sci2web/.results.info.temp</span></tt>.  Copy
this file to the main directory of the application and edit it to add
the results variables associated to your application.  For our example
application we define a result variable called <tt class="docutils literal">MeanDispersions</tt>
that will be set after the execution of the application with the
average number of dispersions suffered by the dust particles:</p>
<pre class="literal-block">
sci2web/.results.info.temp:

MeanDispersions=[[MeanDispersions::0::float::Average number of dispersions::Results::General::This is a result variable::readonly]]

% cp sci2web/.results.info.temp .
</pre>
<p>The <tt class="docutils literal">tab</tt> and <tt class="docutils literal">group</tt> for the results variables should not be
modified.</p>
<div class="important">
<p class="first admonition-title">Important</p>
<p>In order to use properly the results variable feature
of <a class="reference external" href="http://localhost/user/Sci2WebPP">Sci2Web</a> you should configure your application to write down the
value of these variables after the execution of a running instance.
For our example application it could be done for example changing
the master source file including the following lines:</p>
<p>Original code:</p>
<pre class="literal-block">
for(i=ini;i&lt;=N;i++){
  condition=((i%per)==0 || i==ini);
  [...]
  j=0;
  do{
    d=-lambda*log(drand48())*CUSTOM_UNITS;
    theta=2*M_PI*drand48();
    x=x+d*cos(theta);
    y=y+d*sin(theta);
    if(condition) fprintf(fp,&quot;%d %e %e\n&quot;,j,x,y);
    j++;
  }while(x*(x-l)&lt;=0 &amp;&amp; y*(y-h)&lt;=0);
  fprintf(fl,&quot;%d\t%e\t%e\n&quot;,i,x,y);
  if(condition){
    fprintf(stdout,&quot;i = %d, (x,y) = (%.2e,%.2e)\n&quot;,i,x,y);
    sleep((int)SLEEP);
  }
}
</pre>
<p>New code:</p>
<pre class="literal-block">
nidsp=0;
for(i=ini;i&lt;=N;i++){
  condition=((i%per)==0 || i==ini);
  [...]
  j=0;
  do{
    d=-lambda*log(drand48())*CUSTOM_UNITS;
    theta=2*M_PI*drand48();
    x=x+d*cos(theta);
    y=y+d*sin(theta);
    if(condition) fprintf(fp,&quot;%d %e %e\n&quot;,j,x,y);
    j++;
  }while(x*(x-l)&lt;=0 &amp;&amp; y*(y-h)&lt;=0);
  ndisp+=j;

  fprintf(fl,&quot;%d\t%e\t%e\n&quot;,i,x,y);
  if(condition){
    fprintf(stdout,&quot;i = %d, (x,y) = (%.2e,%.2e)\n&quot;,i,x,y);
    sleep((int)SLEEP);
  }
}
ndisp=ndisp/N;
FILE *fr;
fr=fopen(&quot;results.info&quot;,&quot;w&quot;);
fprintf(fr,&quot;MeanDispersions=%lf\n&quot;,ndisp);
fclose(fr);
</pre>
<p class="last">If you cannot change your source file or simply does not want to do
it we recommend to use external scripts able to extract the results
from any output of the program (standard or standard error, output
files, etc.)</p>
</div>
<p>Once you have selected the control and results variables and have
created the templates from the files where those variables appear you
are ready to test the generation of source files for your runs from
those templates.  This a critical step in the generation of new
instances of the application.  To perform this important step run:</p>
<pre class="literal-block">
% perl sci2web/bin/sci2web.pl contvars --appdir .
</pre>
<p>Here we are using the symbolic link to the utility script binary
directory created in the sci2web subdirectory already installed after
the initialization of the application.</p>
<div class="important">
<p class="first admonition-title">Important</p>
<p>If you perform any changes in your control variables
and want to update the templates for all the application instances
already created in <a class="reference external" href="http://localhost/user/Sci2WebPP">Sci2Web</a> you should use the absolute path of the
utility script:</p>
<pre class="last literal-block">
% perl PROJPATH/sci2web/bin/sci2web.pl contvars --appdir .
</pre>
</div>
<p>This command create three files in the <tt class="docutils literal">sci2web</tt> subdirectory:
<tt class="docutils literal">controlvars.info</tt>, <tt class="docutils literal">controlvars.sql</tt> and
<tt class="docutils literal">templates/Default.conf</tt>.  The first one is the list of the control
variables classified by tabs and groups and properly formatted to be
used by the <a class="reference external" href="http://localhost/user/Sci2WebPP">Sci2Web</a> tool.  The second one is a sql file that will be
used in the installation step to create a table associated to the
particular version of the application where the values of the control
variables and other results are stored by each run created by the
community using the application. It is strongly recommended to avoid
the edition of this file.  The third and last file, <tt class="docutils literal">Default.conf</tt>
is a sample <em>run configuration file</em> containing the value of the
control variables that will be used to generate the files for a given
run.  In this case the values are the default ones defined when the
control variables were described using the substitution rule.</p>
<p>At this point you can try to generate the files for your application
using the template files and the default <em>run configuration file</em>
(<tt class="docutils literal">sci2web/templates/Default.conf</tt>) just created.  To perform this
run:</p>
<pre class="literal-block">
% perl sci2web/bin/sci2web.pl genfiles --runconf sci2web/templates/Default.conf --rundir .
</pre>
<p>This command will create the run files corresponding to each template
you have previously created.  In our sample they correspond to the
<tt class="docutils literal">parameters.ini</tt> and <tt class="docutils literal"><span class="pre">plot-out.gpl</span></tt> files.  Please check these
files and verify that they have the proper content.  Another file is
created <tt class="docutils literal">run.conf</tt>.  This is a copy of the run configuration file
and can be used to know what are the values of the control variables
used in a particular run.</p>
<p>You can play around modifying <tt class="docutils literal">run.conf</tt> and generating again the
run files:</p>
<pre class="literal-block">
% perl sci2web/bin/sci2web.pl genfiles --runconf run.conf --rundir .
</pre>
<p>This exercise will give you an idea if your template files and control
variable configuration files are properly prepared.</p>
<p>The ultimate test is to generate test run files using a particular set
of values properly set up in your <tt class="docutils literal">run.conf</tt> and see if your
application compiles and run as expected.</p>
<p>Be sure that you have test it your newly configured application before
to proceed with the following steps.</p>
</div>
<div class="section" id="configure-your-application">
<h3><a class="toc-backref" href="#id9">Configure your application</a></h3>
<p>Control variables are the most important component of a <a class="reference external" href="http://localhost/user/Sci2WebPP">Sci2Web</a>
ported applications.  At this point you have initialized your
application and configured how a running instance will be parametrized
and generated through the control variables you have just defined.</p>
<p>There are other important aspects of your application that need to be
configured before to install it at the Sci2Web server site.  Please
follow carefully the next procedure to complete your configuration:</p>
<ol class="arabic">
<li><p class="first"><strong>The running pipeline</strong>.  In real life every NDSA is normally ran
following a fixed set of system commands, a.k.a. the <em>running
pipeline</em>.  For example you could start by cleaning the run
directory, then you compile your source files, run your
application, perform several post-run actions and check your
results.</p>
<p>The <a class="reference external" href="http://localhost/user/Sci2WebPP">Sci2Web</a> control scripts run every ported application following
a fixed pipeline that should be configured using the
<tt class="docutils literal">sci2web/runpipeline.conf</tt> file.  You can provide there the
explicit commands (<tt class="docutils literal">&lt;ACTION&gt;CMD</tt>, where <tt class="docutils literal">&lt;ACTION&gt;</tt> could be
<tt class="docutils literal">CLEAN</tt>, <tt class="docutils literal">COMPLIE</tt>, <tt class="docutils literal">SUBMIT</tt>, etc., see below) or the name of
specially prepared scripts (<tt class="docutils literal">&lt;ACTION&gt;SCR</tt>) that should be
executed at each step of the running pipeline.</p>
<p>The <a class="reference external" href="http://localhost/user/Sci2WebPP">Sci2Web</a> pipeline recognize the following set of actions:</p>
<ul class="simple">
<li><em>Clean</em>.  Clean of the run directory.  This action should be
configured if the run directory must be cleaned before to run the
application.</li>
<li><em>Compile</em>.  Compile the source files of the application.  This
action should be configured if your application requires some
kind of compilation.  It should not be configured if you are
using already compiled programs or not compiling languages
(e.g. perl, bash, python).</li>
<li><em>Preparation</em>.  Prepare the run directory to run the application.
Configure this action if your application require some previous
preparation before to run it.</li>
<li><em>Submit</em>. Run the application.  Here you should say the system
what is the particular command used to run your application.</li>
<li><em>Pause</em>.  Pause a running application.  Configure this step only
if your application could be paused.  Pausing is a special
feature of an application that allows you to temporally suspend a
running instance and resume it exactly where the computation be
when the instance was interrupted.  Not all the applications
could be paused but if you can program this feature in your
source files it could be a very useful property.  Leave blanck
both <tt class="docutils literal">PAUSESCR</tt> and <tt class="docutils literal">PAUSECMD</tt> variables if the application
is not <em>pausable</em>.  In this case the action <em>Pause</em> will trigger
the <em>Kill</em> action on the application.</li>
<li><em>Stop</em>. Stop a running application.  Here applies the same
recommendations given for the <em>Pause</em> step.</li>
<li><em>Post</em>.  Commands to be executed after the running instance of
the application has finished.</li>
<li><em>Status</em>.  Check the status of the run.  The commands configure
here should be able to return a number between 0 and 1 with the
degree of advance of your run.  If you are not able to check this
return a -1 value as the running status.</li>
</ul>
<p>The <tt class="docutils literal">runpipeline.conf</tt> file for our example application will look
like:</p>
<pre class="literal-block">
#######################################################################
#RUN PIPELINE
#######################################################################

#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
#CUSTOM CLEAN COMMAND OR SCRIPT
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
CLEANSCR=&quot;&quot;
CLEANCMD=&quot;make cleanall&quot;

#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
#CUSTOM COMPILE COMMAND OR SCRIPT
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
COMPILESCR=&quot;&quot;
COMPILECMD=&quot;make diffusion.out&quot;

#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
#CUSTOM PRE COMMAND OR SCRIPT
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
PRESCR=&quot;&quot;
PRECMD=&quot;make clean&quot;

#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
#CUSTOM SUBMIT COMMAND OR SCRIPT
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
SUBMITSCR=&quot;&quot;
SUBMITCMD=&quot;./diffusion.out salida.txt&quot;

#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
#CUSTOM PAUSE COMMAND OR SCRIPT
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
PAUSESCR=&quot;&quot;
PAUSECMD=&quot;echo Pausing...&quot;

#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
#CUSTOM RESUME COMMAND OR SCRIPT
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
RESUMESCR=&quot;&quot;
RESUMECMD=&quot;echo Resuming...&quot;

#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
#CUSTOM STOP COMMAND OR SCRIPT
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
STOPSCR=&quot;&quot;
STOPCMD=&quot;echo Stopping...&quot;

#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
#CUSTOM POST RUN COMMAND OR SCRIPT
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
POSTSCR=&quot;&quot;
POSTCMD=&quot;gnuplot plot-out.gpl&quot;

#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
#CUSTOM STATUS COMMAND OR SCRIPT
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
STATUSSCR=&quot;stat.sh&quot;
STATUSCMD=&quot;echo -1&quot;
</pre>
<p>It should be mentioned that the <tt class="docutils literal">&lt;ACTION&gt;SCR</tt> value overrides the
<tt class="docutils literal">&lt;ACTION&gt;CMD</tt> command.  Thus for example in the last part of the
previous example file the <tt class="docutils literal">STATUSSCR</tt> is executed beside the fact
that a <tt class="docutils literal">STATUSCMD</tt> has been also provided.</p>
<p>It is strongly recommended to test the running pipeline
configuration by trying to use the <a class="reference external" href="http://localhost/user/Sci2WebPP">Sci2Web</a> utility script
<tt class="docutils literal">sci2web.sh</tt>.  This is the script that the <a class="reference external" href="http://localhost/user/Sci2WebPP">Sci2Web</a> web tools
will use when trying to control your application.  Test it by
running:</p>
<pre class="literal-block">
% bash sci2web/bin/sci2web.sh clean
</pre>
<p>If it works as expected, executing the Clean command or script you
have configured in the <tt class="docutils literal">runpipeline.conf</tt> file try to run other
and more complex actions:</p>
<blockquote>
<p>% bash sci2web/bin/sci2web.sh compile
% bash sci2web/bin/sci2web.sh pre</p>
</blockquote>
<p>The most critical action is the <em>Submit</em> one.  Verify that it works
as expected:</p>
<pre class="literal-block">
% bash sci2web/bin/sci2web.sh submit
Executing action submit:
Signal: submit
Set submit
warning: commands will be executed using /bin/sh
job 457 at Fri Dec  9 10:56:00 2011
</pre>
<p>If it works properly not only you will notice that the expected
output files of your application will start to appear but also a
set of <tt class="docutils literal">.oxt</tt> files are generated: <tt class="docutils literal">jobid</tt>,
<tt class="docutils literal">pid</tt>,``time_start``, <tt class="docutils literal">time_end</tt>, <tt class="docutils literal">stdout</tt>, <tt class="docutils literal">stderr</tt> among
others.  These files contain critical information about the running
instance used by <a class="reference external" href="http://localhost/user/Sci2WebPP">Sci2Web</a> to display information related to your
run.</p>
<p>If any problem is detected please check the <tt class="docutils literal">runpipeline.conf</tt>
configuration file and other scripts you are using to run your
application.</p>
<div class="important">
<p class="first admonition-title">Important</p>
<p><a class="reference external" href="http://localhost/user/Sci2WebPP">Sci2Web</a> uses by default the batch execution system
<tt class="docutils literal">at</tt>.  It will try to execute all the running instances on the
local web server despite the fact that the processor is very
busy. This is not a recommended configuration and should be used
only if you are using <a class="reference external" href="http://localhost/user/Sci2WebPP">Sci2Web</a> for personal purposes.</p>
<p>If you want to work with a different batch execution system the
<a class="reference external" href="http://localhost/user/Sci2WebPP">Sci2Web</a> site server manager should change the <tt class="docutils literal">sci2web.sh</tt>
script to prepare the job submission accordingly.</p>
<p>For example if you want to change <tt class="docutils literal">at</tt> for <tt class="docutils literal">batch</tt> (which
launches proccesses only if the server load is low enough) you
should replace the <tt class="docutils literal">at now</tt> command for the <tt class="docutils literal">bacth</tt> command
in the following part of the <tt class="docutils literal">sci2web.sh</tt> script:</p>
<pre class="last literal-block">
#&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;
#THESE LINES CAN BE CHANGED ACCORDING TO YOUR QUEUE SYSTEM
#&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;
if ! at now &lt; /tmp/apprun.$$ &amp;&gt; /tmp/jobinfo.$$;then
    echo &quot;Error submitting your job:&quot;
    cat /tmp/jobinfo.$$
    rm -rf /tmp/*.$$
    exit 1
fi
cat /tmp/jobinfo.$$
jobid=$(tail -n 1 /tmp/jobinfo.$$ | cut -f 2 -d ' ')
echo $jobid &gt; jobid.oxt
#&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;
#&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;
</pre>
</div>
<p>The utility script <tt class="docutils literal">sci2web.sh</tt> includes another actions that
could be useful for other purposes: <strong>cleanall</strong>, cleans all the
run directory including files generated by the control script;
<strong>test</strong>, performs a complete test on the running instance
including pause, stop and resume commands; <strong>kill</strong>, kills the
presently running instance; <strong>status</strong> check the status of the
running instance.  You can run several action in tandem:</p>
<pre class="literal-block">
% bash sci2web/bin/sci2web.sh cleanall compile pre submit
</pre>
<p>This is the recommended way to test the running pipeline.</p>
</li>
<li><p class="first"><strong>Select common files</strong>.  When <a class="reference external" href="http://localhost/user/Sci2WebPP">Sci2Web</a> creates a new instance of
an application many files could be duplicated what compromises the
storage capacity of tou web server.  Many of those duplicated files
could be shared among different running instances reducing the
space required to have an active <a class="reference external" href="http://localhost/user/Sci2WebPP">Sci2Web</a> application.  You can
list the files that will be shared using the
<tt class="docutils literal">sci2web/sharedfiles.info</tt> file.  One object should be listed per
line in this file.  For our example application if you want to
share the files <tt class="docutils literal">Makefile</tt> and all the files having the name
diffussion, and the directory <tt class="docutils literal">gsl</tt> the
<tt class="docutils literal">sci2web/sharedfiles.info</tt> will look like:</p>
<pre class="literal-block">
Makefile
diffusion.*
gsl
</pre>
</li>
<li><p class="first"><strong>Select output files</strong>.  When an instance of an application is
finished <a class="reference external" href="http://localhost/user/Sci2WebPP">Sci2Web</a> stores by default all the results produced by the
application in a results database.  It is obvious that many files
involved in your application should not be stored since they are
repeated among instances or they do not contain useful information.
You can use the <tt class="docutils literal">sci2web/outfiles.info</tt> to list, with a similar
syntax as that used for the shared files, the most interesting
files to be saved as results of your running instance.  For our
example application this file could look like:</p>
<pre class="literal-block">
*.dat
*.png
scratch
</pre>
<p>All the <tt class="docutils literal">.oxt</tt> and the <tt class="docutils literal">.conf</tt> files, created and used by
<a class="reference external" href="http://localhost/user/Sci2WebPP">Sci2Web</a> will be stored by default.</p>
</li>
<li><p class="first"><strong>Web interface configuration</strong>.  The web interface of your
application have the following components:</p>
<ul>
<li><p class="first"><em>The information web pages</em>.  This is a set of editable web pages
containing information about your application.  These pages could
be freely edit by the creator of the application and the
crontibutors of the respective version.  These are the pages that
any visitor will be first see when openning the page of your
application.  It is strongly recommended to include in the web
pages information as ecomplete as possible about your application
including links to possible documentation (that could be also
stored in the server site), download options (if applicable) or
links to the <a class="reference external" href="http://localhost/user/Sci2WebPP">Sci2Web</a> documentation (specially to the user
guide).</p>
<p>You can disable the information web pages by editing the
configuration file <tt class="docutils literal">sci2web/version.conf</tt> and changing the
variable <tt class="docutils literal">VerTabs</tt>.  This variable controls what tabs and in
which order will be displayed in the application web page.  There
are five fixed tabs: <tt class="docutils literal">description</tt>, <tt class="docutils literal">documentation</tt>,
<tt class="docutils literal">downloads</tt>, <tt class="docutils literal">runs</tt>, <tt class="docutils literal">database</tt>.  To disable the
information pages the version tabs variable should be:</p>
<pre class="literal-block">
VerTabs = runs:Runs;database:Database
</pre>
</li>
<li><p class="first"><em>The queue system</em>.  <a class="reference external" href="http://localhost/user/Sci2WebPP">Sci2Web</a> manages the execution of running
instances of the mutiple applications installed in a server site
in a similar fashion that a <em>job queue system</em>.  This feature is
particularly useful when the installed applications normally
takes a long time to be executed.  The queue system component of
<a class="reference external" href="http://localhost/user/Sci2WebPP">Sci2Web</a> is a specially designed page where a list of the running
or already ran applications are displayed.  Using this page you
will be able to create a new instance (run your application),
remove existent instances or control the execution of already
created instances.</p>
<p>If your application is too simple and does not require a complete
queue system you can switch to a simpler interface called the
<tt class="docutils literal">RunHistory</tt> mode.  Again the <tt class="docutils literal">sci2web/version.conf</tt> file
should be use to modify this behavior:</p>
<pre class="literal-block">
QueueMode = RunHistory
</pre>
<p>You can turn back to the queue system changing the name of the
variable to <tt class="docutils literal">QueueList</tt> (default choice).</p>
<blockquote>
<p>QueueMode = QueueList</p>
</blockquote>
</li>
<li><p class="first"><em>The results database</em>.  All the run instances succesfully
executed with your applications and their result files will be by
default stored in a big result database.  This is a very useful
feature of <a class="reference external" href="http://localhost/user/Sci2WebPP">Sci2Web</a> that could allow a community to access
already computed results that in other case will be very
expensive to recompute.</p>
<p>Imagine this scenario: your application is able to compute the
dynamical evolution of a two planets system changing the initial
conditions of the biggest planet.  You could vary in a huge
parameter space the initial properties of the big planet and
every configuration is a single result.  After performing a
complete parameter space exploration an user could store results
that will be useful for others desiring to explore the same or an
overlapping region of the parameter space.  With the results
database all they have to do is search for the results already
computed for that part of the parameter space and compute only
new results in the unexplored region.</p>
<p><a class="reference external" href="http://localhost/user/Sci2WebPP">Sci2Web</a> provide to any application with a special designed page
to search for results stored in the database.</p>
<p>If your application is very simple or you do not want to store a
big amount of data coming from all the results computed with your
application disable this feature using the variable
<tt class="docutils literal">ResultsDatabase</tt> in the <tt class="docutils literal">sci2web/version.conf</tt> file:</p>
<pre class="literal-block">
ResultsDatabase = false
</pre>
<p>You can turn in this feature in any moment by setting the value
of this variable to <tt class="docutils literal">true</tt>.</p>
</li>
<li><p class="first"><em>The configuration form window</em>. Probably the most important
component of the whole web interface is the configuration window.
This component allows the final user to input the value of the
control variables, modify other properties of the running
instance and control the execution of your application.  There
are several attributes of the configuration window that can be
customized:</p>
<blockquote>
<ul class="simple">
<li>TabHeight (value given in <tt class="docutils literal">px</tt> or <tt class="docutils literal">%</tt>, default 80%):
Height of the configuration tabs used to display the input
forms for the control variables.</li>
<li>RunTab (boolean, default <tt class="docutils literal">true</tt>): Determines if a special
tab is included to input potential editable information about
the run.</li>
<li>FilesTab (boolean, default <tt class="docutils literal">true</tt>): Determines if a tab with
the list of files associated to the run are displayed or not.</li>
<li>ControlButtons (boolean, default <tt class="docutils literal">true</tt>): Determines if the
configuration window should have the buttons used to control
the application.</li>
</ul>
</blockquote>
<p>All these properties can be set up in the
<tt class="docutils literal">sci2web/version.conf</tt> file.</p>
</li>
<li><p class="first"><em>The results window</em>.  The result window is an important
component of the interface intended to display customizable
information about the results of the running instance.  A
separate configuration file <tt class="docutils literal">sci2web/resultswindow.conf</tt> for
this component is included and should be edited to change the
default behavior:</p>
<pre class="literal-block">
###################################################
#RESULTS WINDOW CONFIGURATION FILE
#Use this file to describe your results window
###################################################

#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
#STATUS AND CONTROL TAB
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Tab=Status
Content=Module:Status
RefreshTime=5000

#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
#STANDARD OUTPUT AND STANDARD ERROR
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Tab=Output
Content=File:stdout.oxt;File:stderr.oxt
RefreshTime=1000

#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
#FILES TAB
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Tab=Files
Content=Module:ListFiles?SubDir=.&amp;Filter=*
RefreshTime=-1
</pre>
</li>
</ul>
<blockquote>
<p>As you can see there is an entry for every tab you want to include
in the results window.  Every entry has three properties: <tt class="docutils literal">Tab</tt>
(name of the tab), <tt class="docutils literal">Content</tt> (content of the tab) and
<tt class="docutils literal">RefreshTimes</tt> (time to refresh the content of the tab).</p>
<p>The content of a tab could be selected among these options:</p>
<ul>
<li><p class="first"><strong>File</strong>: the content of the tab will the content of the file
indicated after ':'.  The default file path is the run
directory.</p>
</li>
<li><p class="first"><strong>Module</strong>: a particular module programmed into the <a class="reference external" href="http://localhost/user/Sci2WebPP">Sci2Web</a>
tools.  Available modules are:</p>
<ul class="simple">
<li><em>Status</em>: show the status of the run.  No parameters are
required.</li>
<li><em>ListFiles</em>: list of files of a given subdirectory in the run
directory.  Parameters: <tt class="docutils literal">SubDir</tt>, <tt class="docutils literal">Filter</tt>.</li>
</ul>
<p>Parameters are given to modules using the same syntax as <tt class="docutils literal">php</tt>
scripts using an initial <tt class="docutils literal">?</tt> and <tt class="docutils literal">&amp;</tt> to separate different
module parameters.</p>
</li>
</ul>
<p>The <tt class="docutils literal">RefreshTime</tt> is given in milliseconds.  You should be
carefull to not set a very small refresh time for your tabs
because it could load your web server with apache2 zombie
processes.</p>
</blockquote>
</li>
</ol>
</div>
</div>
<div class="section" id="installing-your-application-in-your-sci2web-server-site">
<h2>Installing your application in your <a class="reference external" href="http://localhost/user/Sci2WebPP">Sci2Web</a> server site</h2>
<p>The last steps in order to have your application succesfully installed
in the <a class="reference external" href="http://localhost/user/Sci2WebPP">Sci2Web</a> server site is to copy the application files in the
server directory and register your application in the master database.
These steps could be executed with a single command:</p>
<pre class="literal-block">
% perl SCI2WEB_PATH/bin/sci2web.pl install --appdir .
</pre>
<div class="important">
<p class="first admonition-title">Important</p>
<p>Notice that you should call the utility script
<tt class="docutils literal">sci2web.pl</tt> using the absolute path instead of using the
symbolic link to the <tt class="docutils literal">bin</tt> directory.  This command will fail to
install your application:</p>
<pre class="last literal-block">
% perl sci2web/bin/sci2web.pl install --appdir .
</pre>
</div>
</div>
<div class="section" id="testing-your-newly-ported-application">
<h2><a class="toc-backref" href="#id11">Testing your newly ported application</a></h2>
<p>If everything has been ran smoothly up to this point you are ready to
start using your application with a brand new web interface!</p>
<p>But, wait a minute! Your work has not ended here.  Probably it has
just started.  As every programming task you do not end until you have
ran and test your application in its final form.  So go to the
<a class="reference external" href="http://localhost/user/Sci2WebPP">Sci2Web</a> server site URL, sign up or sign in into an account and start
testing your application.  Seeing your application in action will give
you hints to modify the configuration you have just completed.  The
process will finish only when you are completely satisfied with the
result.  And even thens you will still have to wait for the bug reports
the user community using your application will start to send you.</p>
<p>From now on, start to work directly in the application directory at
your <a class="reference external" href="http://localhost/user/Sci2WebPP">Sci2Web</a> server site.  Only the changes performed there will be
reflected in the running instances created from the web interface.</p>
<p>Good luck!</p>
<hr class="docutils" />
<p>Copyright (C) 2011 Jorge I. Zuluaga</p>
</div>
</div>
</div>
</body>
</html>
